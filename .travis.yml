language: generic
before_install:
- sudo apt-get install texlive-binaries
- chmod +x .travis/git-info-2.sh
- ".travis/git-info-2.sh"
install:
- export PATH="$HOME/miniconda/bin:$PATH"
- if ! command -v conda > /dev/null; then wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
  -O miniconda.sh; bash miniconda.sh -b -p $HOME/miniconda -u; conda config --add
  channels conda-forge; conda config --set always_yes yes; conda install tectonic==0.1.11;
  fi
- conda install -c malramsay biber==2.11 --yes
- conda info -a
cache:
  directories:
  - "$HOME/miniconda"
  - "$HOME/.cache/Tectonic"
script:
- cd ./src/
- tectonic --keep-intermediates --reruns 0 ./main.tex
- if [ -f "main.bcf" ]; then biber main; fi
- tectonic ./main.tex --print
- cd ../
deploy:
  provider: releases
  api_key:
    secure: Ex2czz8NuQUaEbCzbk7r18gi+1jGG7GdYjj+0Y96GQpk2T853oJiBIUpcnHARs/gS00fQds8cRRxFh2/r7srT71pyPJFZDcpWL24Iik4Da4oL2VbcSLL4rLRzrb1EK3KwNPai+MJtRrAq+klIXHH+vU2hfulcjRckEO93kWki/KoYq2UiaFucFwr5olj5nT7eFkjDaRSWGS0cQT7egqns7F5BUAFi/a6e30f3DAShV61o+gGSfnigpNVUdJcAeoIgmWNe4Pcv00D2XpX+o1IrZJ8bFzcyx/3qPiByAKfVHD8vNJU+ELd/O3OxFhfooH2DzxsJUnlqL4RtJtxzM/hL0fh5X8d2RyfoRjMgnrAHv3Gtz3pcWnNfkAZAN+JYDC0O83/z8M2mjQyx3GmxcrLchEPwUmyyyjHSOKB5D80QvJiGDhHXh5xRE2DddHegvHCvB5YmM9hoev29aulv4tju9zDGMivV/5fGh9NQ4Ayw+yKIaKTMxNr1MqpWOMO+Ikr//ZcmmhLqTri2w3UmyYzaOpIEZySe9EVpEPZkwEadw0T8lx+9CAI8QfqZ5zvTD/kSDFsiemROBZvAso7Fi3NyzTDN1nmFtXExALBZ6KE6cxXp6WdazS5o+8IdYjWKunWrTImLXlIVzP+69Sc0RJ0HFlbmPqggBoT7tupsHj+cKQ=
  file:
    - ./src/git-info-2-mwe.pdf
  skip_cleanup: true
  on:
    repo: PHPirates/travis-ci-latex-pdf
    branch: gitinfo2
